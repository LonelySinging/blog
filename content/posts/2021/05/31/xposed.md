---
title: "Xposed初体验"
date: 2021-05-31T19:33:48+08:00
draft: true

---

# Xposed

对于`Xposed`这个框架，在很早之前就已经了解到了，那时候是用它来实现自动抢红包这样的功能，总之是一个非常厉害的框架。不过这些年似乎热度正逐渐被`Magisk`夺取，不过因为两者实现方式不同，所以在不同的场景下还是各有各的存在意义。比如说`Magisk`使用起来风险更低，因为它并没有真正修改系统文件，也就不会轻易出现系统崩溃，卡开机屏的问题。不过要说插件数量，据我所知还是老牌的`Xposed`比较多。

`Xposed`是通过劫持安卓系统最初始的进程`zygote`实现工作的，任意一个进程总是通过`fork zygote`产生的，所以，`Xposed`劫持了它之后，就能对其他进程做任何事情了。

因为目前并不打算`root`手中的主力机，所以打算使用一部不用的手机`金立s5`来作为试验机，不过在我辛苦的`root`它之后，发现想要安装`Xposed`还真是麻烦。并且我也不想维护两个手机，并且我知道手机上会有虚拟机，它一般都会自带`Xposed`框架。由此，觉得`Xposed`会更方便。说起来，如果在主力机上面实现了一些实用的功能，使用起来也会很方便。

我也尝试过安装`Magisk`，但是，并没有成功，在通过`fastboot`刷写`boot`的时候电脑一直找不到设备，不清楚是驱动问题，还是手机限制的问题，而且这部手机网上能找到的资料很少，所以不方便折腾。于是就完全放弃了使用`s5`作为试验机的想法。



# 环境搭建

目前手持主力机`红米K30U`，联发科的SOC使得这个手机像是后娘养的一样，啥东西都赶不上热乎的，希望未来随着滥发可机型变多小米能够对其有更多的优化。不过好在并不影响我的使用。

现在的设想是通过安装`VMOS`这个虚拟机软件在手机上面运行一个系统，免费版本的是`Android 5.1.1`，里面带了`ROOT`还有`Xposed`并且能够很方便的打开`网络adb`方便使用笔记本对其操作，实际上这也是安装软件和传输文件最方便的方式了，尤其是能够和`Android Studio`无缝协作。

## 配置开发环境

### 安装Android Studio (AS)

下载链接在此https://developer.android.google.cn/studio/

此时有需要说明的是，网络上讲关于`Xposed`模块开发的教程都会提到关闭`AS`的`Instant Run`，但是我下载最新版本之后，在设置中并没有找到这个的设置项。让我困惑了很久，直到无意间了解到这个功能在`3.5`版本的时候就被谷歌"优化"掉了。被新的`Alpply Change`功能替代了。但是不清楚这个新的功能是否会导致出现教程中说到的异常，我是用的是`Android Studio 3.2.1`好在官网能够下载到。

安装之后，国内可能需要设置代理才能够愉快的下载`SDK`以及相关`jar`依赖库，毕竟是谷歌的服务，被墙了也是毫不意外的事情。

之后，需要下载`SDK`，建议下载`7.1.1 (API 25)`、`5.1.1 (API 22)`，这两个是最多的版本了，另外，对于`Android Studio 3.2.1`来说，`SDK 10 (API 29)`似乎是必须安装的，对于`Android Studio 4.2`来说，必须安装`SDK 11 (API 30)`，总共下载大小似乎还没有超过一个G。所以梯子流量不多的人也不用担心。

### 创建项目

再然后，创建一个项目，可以是没有`MainActivity`的项目，不过我选择了一个`Empty MainActivity`的项目，目的是为了好看 : P 

### 添加新的

需要在项目中添加 (具体参看网上很多的教程，这部分是没有问题的)

```xml
<meta-data
    android:name="xposedmodule"
    android:value="true" />
<meta-data
    android:name="xposeddescription"
    android:value="我是一个Xposed例程" />
<meta-data
    android:name="xposedminversion"
    android:value="53" />
```

